{{ 'car-parts-search.css' | asset_url | stylesheet_tag }}

<section class="car-parts-search" id="car-parts-search-{{ section.id }}">
  <div class="page-width">
    <div class="car-parts-search__wrapper">
      <div class="car-parts-search__header">
        <h2 class="car-parts-search__title">{{ section.settings.title | default: "–ù–∞–º–µ—Ä–∏ —á–∞—Å—Ç–∏ –∑–∞ —Å–≤–æ—è –∞–≤—Ç–æ–º–æ–±–∏–ª" }}</h2>
        <p class="car-parts-search__subtitle">{{ section.settings.subtitle | default: "–ò–∑–±–µ—Ä–∏ –º–æ–¥–µ–ª –∏–ª–∏ –≤—ä–≤–µ–¥–∏ VIN –Ω–æ–º–µ—Ä –∑–∞ –±—ä—Ä–∑–∞ –∏ —Ç–æ—á–Ω–∞ —Ç—ä—Ä—Å–∞—á–∫–∞" }}</p>
      </div>

      <!-- Manual Search Form (Default) -->
      <div class="car-parts-search__form-container" id="manual-search-form">
        <form class="car-parts-search__form" id="car-search-form" action="{{ routes.search_url }}" method="get">
          <input type="hidden" name="type" value="product">
          <input type="hidden" name="options[unavailable_products]" value="last">
          
          <div class="car-parts-search__fields">
            <!-- Year Dropdown -->
            <div class="car-parts-search__field">
              <label class="car-parts-search__label" for="car-year">
                <span class="car-parts-search__icon">üóìÔ∏è</span>
                –ì–æ–¥–∏–Ω–∞
              </label>
              <select class="car-parts-search__select" id="car-year" name="year" required>
                <option value="">–ò–∑–±–µ—Ä–∏ –≥–æ–¥–∏–Ω–∞</option>
                <!-- Years will be populated by JavaScript -->
                {% comment %} Dynamic population: for year in (1990..current_year) {% endcomment %}
                {% assign current_year = 'now' | date: '%Y' | plus: 0 %}
                {% for i in (1990..current_year) %}
                  {% assign year = current_year | minus: forloop.index0 %}
                  <option value="{{ year }}">{{ year }}</option>
                {% endfor %}
              </select>
            </div>

            <!-- Brand Dropdown -->
            <div class="car-parts-search__field">
              <label class="car-parts-search__label" for="car-brand">
                <span class="car-parts-search__icon">üöó</span>
                –ú–∞—Ä–∫–∞
              </label>
              <select class="car-parts-search__select" id="car-brand" name="brand" required disabled>
                <option value="">–ü—ä—Ä–≤–æ –∏–∑–±–µ—Ä–∏ –≥–æ–¥–∏–Ω–∞</option>
                <!-- Brands will be populated by JavaScript based on year selection -->
                {% comment %} Dynamic brands: BMW, Mercedes, Audi, Volkswagen, Toyota, Honda, etc. {% endcomment %}
              </select>
            </div>

            <!-- Model Dropdown -->
            <div class="car-parts-search__field">
              <label class="car-parts-search__label" for="car-model">
                <span class="car-parts-search__icon">‚öôÔ∏è</span>
                –ú–æ–¥–µ–ª
              </label>
              <select class="car-parts-search__select" id="car-model" name="model" required disabled>
                <option value="">–ü—ä—Ä–≤–æ –∏–∑–±–µ—Ä–∏ –º–∞—Ä–∫–∞</option>
                <!-- Models will be populated by JavaScript based on brand selection -->
              </select>
            </div>
          </div>

          <button type="submit" class="car-parts-search__submit-btn" id="search-parts-btn">
            <span class="car-parts-search__btn-icon">üîç</span>
            –¢—ä—Ä—Å–∏ —á–∞—Å—Ç–∏
          </button>
        </form>

        <!-- Toggle to VIN Search -->
        <div class="car-parts-search__toggle">
          <button type="button" class="car-parts-search__toggle-btn" id="toggle-to-vin">
            –ó–Ω–∞–µ—à —Å–≤–æ—è VIN? <span class="toggle-arrow">‚Üí</span>
          </button>
        </div>
      </div>

      <!-- VIN Search Form (Hidden by default) -->
      <div class="car-parts-search__form-container car-parts-search__form-container--hidden" id="vin-search-form">
        <form class="car-parts-search__form" id="vin-search-form-element">
          <div class="car-parts-search__vin-field">
            <label class="car-parts-search__label" for="vin-input">
              <span class="car-parts-search__icon">üî¢</span>
              VIN –Ω–æ–º–µ—Ä
            </label>
            <input 
              type="text" 
              class="car-parts-search__vin-input" 
              id="vin-input" 
              name="vin" 
              placeholder="–í—ä–≤–µ–¥–∏ VIN –Ω–æ–º–µ—Ä (–Ω–∞–ø—Ä. WBA3A5C56DF586123)"
              maxlength="17"
              autocomplete="off"
            >
            <div class="car-parts-search__vin-info">
              <small>VIN –Ω–æ–º–µ—Ä—ä—Ç —Ç—Ä—è–±–≤–∞ –¥–∞ –µ —Ç–æ—á–Ω–æ 17 —Å–∏–º–≤–æ–ª–∞</small>
            </div>
          </div>

          <button type="submit" class="car-parts-search__submit-btn" id="check-vin-btn">
            <span class="car-parts-search__btn-icon">‚úì</span>
            –ü—Ä–æ–≤–µ—Ä–∏ VIN
          </button>
        </form>

        <!-- Toggle back to Manual Search -->
        <div class="car-parts-search__toggle">
          <button type="button" class="car-parts-search__toggle-btn" id="toggle-to-manual">
            <span class="toggle-arrow">‚Üê</span> –û–±—Ä–∞—Ç–Ω–æ –∫—ä–º —Ä—ä—á–Ω–æ —Ç—ä—Ä—Å–µ–Ω–µ
          </button>
        </div>
      </div>

      <!-- Results/Status Area -->
      <div class="car-parts-search__status" id="search-status"></div>
    </div>
  </div>
</section>

<script src="{{ 'vin-decoder.js' | asset_url }}" defer></script>
<script src="{{ 'car-parts-search.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "–¢—ä—Ä—Å–∞—á–∫–∞ –∑–∞ —á–∞—Å—Ç–∏",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "–ó–∞–≥–ª–∞–≤–∏–µ",
      "default": "–ù–∞–º–µ—Ä–∏ —á–∞—Å—Ç–∏ –∑–∞ —Å–≤–æ—è –∞–≤—Ç–æ–º–æ–±–∏–ª"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "–ü–æ–¥–∑–∞–≥–ª–∞–≤–∏–µ",
      "default": "–ò–∑–±–µ—Ä–∏ –º–æ–¥–µ–ª –∏–ª–∏ –≤—ä–≤–µ–¥–∏ VIN –Ω–æ–º–µ—Ä –∑–∞ –±—ä—Ä–∑–∞ –∏ —Ç–æ—á–Ω–∞ —Ç—ä—Ä—Å–∞—á–∫–∞"
    },
    {
      "type": "range",
      "id": "section_padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "–û—Ç—Å—Ç–æ—è–Ω–∏–µ –æ—Ç–≥–æ—Ä–µ",
      "default": 36
    },
    {
      "type": "range",
      "id": "section_padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "–û—Ç—Å—Ç–æ—è–Ω–∏–µ –æ—Ç–¥–æ–ª—É",
      "default": 36
    }
  ],
  "presets": [
    {
      "name": "–¢—ä—Ä—Å–∞—á–∫–∞ –∑–∞ —á–∞—Å—Ç–∏"
    }
  ]
}
{% endschema %}

<style>
  #car-parts-search-{{ section.id }} {
    padding-top: {{ section.settings.section_padding_top }}px;
    padding-bottom: {{ section.settings.section_padding_bottom }}px;
  }
</style> 